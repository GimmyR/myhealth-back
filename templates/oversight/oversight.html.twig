{% extends "base.html.twig" %}

{% block title %}
	Oversight
{% endblock %}

{% block stylesheets %}
	{{ parent() }}
{% endblock %}

{% block body %}

	<div class="container">
		{% if status < 0 %}
			{{ dump(message) }}
		{% endif %}

		{% if oversight is defined %}
			<div class="row pt-5">
				<h1 class="mx-auto">{{ oversight.title }}</h1>
			</div>
		{% endif %}

		{% if chartDatas is defined %}
			{% for key, value in chartDatas %}
				<div class="row py-5">
					<canvas id="chart-{{ key }}" class="col-md-8 offset-md-2 my-chart"></canvas>
				</div>
			{% endfor %}
		{% endif %}

		{% if (entryDetails is defined) and (parameters is defined) %}
			<div class="col-md-10 offset-md-1 mt-5">
				<table class="table">
					<thead>
						<tr>
							<th scope="col">Date</th>
							{% for parameter in parameters %}
								<th scope="col">{{ parameter.name }}</th>
							{% endfor %}
						</tr>
					</thead>
					<tbody>
						{% for entry in entryDetails %}
							<tr>
								<td>{{entry.date}}</td>
								{% for data in entry.data %}
									<td>{{data.value}}</td>
								{% endfor %}
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		{% endif %}
	</div>

{% endblock %}

{% block javascripts %}

	{{ parent() }}

	<script src="{{ asset('js/chart.min.js') }}"></script>

	{% if chartDatas is defined %}
		<script>
			{% for key, value in chartDatas %}
				const chart{{ key }} = new Chart(document.getElementById('chart-{{ key }}'), {
				type: 'line',
				data: {{ value | json_encode() | raw }}
			});{% endfor %}
		</script>
	{% endif %}

{% endblock %}
